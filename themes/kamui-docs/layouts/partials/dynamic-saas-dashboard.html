{{/* å‹•çš„SaaSãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ç”Ÿæˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ */}}
{{/* data/saas/ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®å…¨YAMLãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã‚“ã§ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‚«ãƒ¼ãƒ‰ã‚’ç”Ÿæˆ */}}

{{/* ã‚«ãƒ†ã‚´ãƒªå®šç¾© */}}
{{- $categories := dict 
  "requirements" (dict "title" "è¦ä»¶å®šç¾©ãƒ»é–‹ç™º" "order" 1)
  "media" (dict "title" "ãƒ¡ãƒ‡ã‚£ã‚¢ã‚¨ãƒ‡ã‚£ã‚¿" "order" 2) 
  "business" (dict "title" "äº‹æ¥­æ§‹ç¯‰" "order" 3)
  "tools" (dict "title" "ãƒ„ãƒ¼ãƒ«ãƒ»ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£" "order" 4)
  "other" (dict "title" "ãã®ä»–" "order" 5)
-}}

{{/* ã‚«ãƒ†ã‚´ãƒªåˆ†é¡é–¢æ•° */}}
{{- define "categorize-app" -}}
  {{- $filename := .filename -}}
  {{- if or (hasPrefix $filename "requirements-") (hasPrefix $filename "ui-views") (hasPrefix $filename "storyboard-viewer") -}}
    requirements
  {{- else if or (hasPrefix $filename "slide-generator") (hasPrefix $filename "ai-portrait-generator") (hasPrefix $filename "dynamic-media-gallery") (hasPrefix $filename "force-graph-3d") (hasPrefix $filename "threejs-3d-editor") -}}
    media
  {{- else if or (hasPrefix $filename "biz-") (hasPrefix $filename "sns-marketing") -}}
    business
  {{- else if or (hasPrefix $filename "prompts-repo") (hasPrefix $filename "private_") -}}
    tools
  {{- else -}}
    other
  {{- end -}}
{{- end -}}

{{/* data/saas/ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‹ã‚‰YAMLãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã¿ */}}
{{- $saasData := dict -}}
{{- range $path, $content := .Site.Data.saas -}}
  {{- $filename := $path -}}
  {{- $category := partial "categorize-app" (dict "filename" $filename) -}}
  {{- $isPrivate := hasPrefix $filename "private_" -}}
  
  {{/* ã‚«ãƒ†ã‚´ãƒªåˆ¥ã«ã‚°ãƒ«ãƒ¼ãƒ—åŒ– */}}
  {{- $categoryList := index $saasData $category | default slice -}}
  {{- $appData := dict "filename" $filename "data" $content "isPrivate" $isPrivate -}}
  {{- $categoryList = $categoryList | append $appData -}}
  {{- $saasData = merge $saasData (dict $category $categoryList) -}}
{{- end -}}

{{/* ã‚«ãƒ†ã‚´ãƒªé †ã§ã‚½ãƒ¼ãƒˆ */}}
{{- $sortedCategories := slice -}}
{{- range $categoryKey, $categoryInfo := $categories -}}
  {{- if index $saasData $categoryKey -}}
    {{- $sortedCategories = $sortedCategories | append (dict "key" $categoryKey "info" $categoryInfo "apps" (index $saasData $categoryKey)) -}}
  {{- end -}}
{{- end -}}

{{/* å‹•çš„ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰å‡ºåŠ› */}}
{{- range $sortedCategories -}}
  <div class="dashboard-sections">
    <h2 class="dashboard-section-title">{{ .info.title }}</h2>
    <div class="dashboard-links">
      {{/* ã‚«ãƒ†ã‚´ãƒªå†…ã‚¢ãƒ—ãƒªã‚’ãƒ•ã‚¡ã‚¤ãƒ«åã§ã‚½ãƒ¼ãƒˆ */}}
      {{- range sort .apps "filename" -}}
        {{- $app := .data -}}
        {{- $filename := .filename -}}
        {{- $isPrivate := .isPrivate -}}
        
        <a href="#{{ $filename }}" class="saas-app-card" onclick="showSectionById('{{ $filename }}'); return false;">
          {{/* å‹•ç”»ã¾ãŸã¯ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç”»åƒ */}}
          {{- if $app.video -}}
            <video src="{{ $app.video }}" alt="{{ $app.title | default $filename }}" style="width: 100%; height: 180px; object-fit: cover; border-radius: 8px; margin-bottom: 12px;" autoplay loop muted playsinline></video>
          {{- else if $app.image -}}
            <img src="{{ $app.image }}" alt="{{ $app.title | default $filename }}" style="width: 100%; height: 180px; object-fit: cover; border-radius: 8px; margin-bottom: 12px;" />
          {{- else -}}
            <div style="width: 100%; height: 180px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 8px; margin-bottom: 12px; display: flex; align-items: center; justify-content: center; color: white; font-size: 1.2rem;">
              {{- if $isPrivate -}}ğŸ”’{{- else -}}ğŸ“Š{{- end -}}
            </div>
          {{- end -}}
          
          <div class="saas-app-title">
            {{ $app.title | default $filename }}
            {{- if $isPrivate -}} ğŸ”’{{- end -}}
            <span class="saas-app-arrow">â†’</span>
          </div>
          
          <div class="saas-app-description">
            {{ $app.description | default "èª¬æ˜ãªã—" | truncate 100 }}
          </div>
          
          {{- if $app.features -}}
            <div class="saas-app-features">
              {{- range first 3 $app.features -}}
                â€¢ {{ . }}<br>
              {{- end -}}
            </div>
          {{- end -}}
        </a>
      {{- end -}}
    </div>
  </div>
{{- end -}}