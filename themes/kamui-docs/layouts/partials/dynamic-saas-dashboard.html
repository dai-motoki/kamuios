{{/* Dynamic SaaS Dashboard Generator */}}
{{/* ã“ã®ãƒ‘ãƒ¼ã‚·ãƒ£ãƒ«ã¯data/saas/ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®å…¨YAMLãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã‚“ã§ã€ã‚«ãƒ†ã‚´ãƒªåˆ¥ã«ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‚’ç”Ÿæˆã—ã¾ã™ */}}

{{/* CSSã‚¹ã‚¿ã‚¤ãƒ«ã®å®šç¾© */}}
<style>
  .dashboard-sections {
    margin-bottom: 40px;
  }
  .dashboard-section-title {
    font-size: 1.4rem;
    font-weight: 700;
    color: var(--text);
    margin-bottom: 20px;
    padding-bottom: 10px;
    border-bottom: 2px solid var(--border);
  }
  .dashboard-links {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 20px;
    margin-bottom: 30px;
  }
  
  .saas-app-card {
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 24px;
    transition: all 0.3s ease;
    cursor: pointer;
    text-decoration: none;
    color: var(--text);
    display: block;
  }
  
  /* ãƒ©ã‚¤ãƒˆãƒ¢ãƒ¼ãƒ‰ã§ç™½èƒŒæ™¯ */
  [data-theme="light"] .saas-app-card {
    background: #ffffff;
    border: 1px solid #e5e7eb;
  }
  
  .saas-app-card:hover {
    transform: translateY(-4px);
    box-shadow: 0 8px 24px rgba(0,0,0,0.15);
    border-color: #4a9eff;
  }
  
  .saas-app-title {
    font-size: 1.3rem;
    font-weight: bold;
    margin-bottom: 12px;
    color: #4a9eff;
    display: flex;
    align-items: center;
    justify-content: space-between;
  }
  
  .saas-app-description {
    font-size: 0.95rem;
    color: var(--text-weak);
    line-height: 1.6;
    margin-bottom: 12px;
  }
  
  .saas-app-features {
    font-size: 0.85rem;
    color: var(--text-weak);
    line-height: 1.8;
  }
  
  .saas-app-arrow {
    color: #4a9eff;
    font-size: 1.2rem;
    display: inline-block;
    margin-left: 8px;
    transition: transform 0.3s ease;
  }
  
  .saas-app-card:hover .saas-app-arrow {
    transform: translateX(4px);
  }
  
  .private-badge {
    background: #ff6b6b;
    color: white;
    padding: 2px 8px;
    border-radius: 12px;
    font-size: 0.7rem;
    font-weight: bold;
    margin-left: 8px;
  }
</style>

<!-- ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
<div class="dashboard-sections">
  <div class="dashboard-links">
    {{/* ãƒ¡ã‚¤ãƒ³ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‚«ãƒ¼ãƒ‰ - å¸¸ã«è¡¨ç¤º */}}
    <a href="#" class="saas-app-card" onclick="window.location.hash=''; location.reload(); return false;">
      <video src="/videos/dashboard_card.mp4" alt="ãƒ¡ã‚¤ãƒ³ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰" style="width: 100%; height: 180px; object-fit: cover; border-radius: 8px; margin-bottom: 12px;" autoplay loop muted playsinline></video>
      <div class="saas-app-title">
        ãƒ¡ã‚¤ãƒ³ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰
        <span class="saas-app-arrow">â†’</span>
      </div>
      <div class="saas-app-description">
        å…¨ä½“ã®ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ - å„ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã¸ã®ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ
      </div>
      <div class="saas-app-features">
        â€¢ è¦ä»¶å®šç¾©ãƒ»é–‹ç™º<br>
        â€¢ ãƒ¡ãƒ‡ã‚£ã‚¢ã‚¨ãƒ‡ã‚£ã‚¿<br>
        â€¢ äº‹æ¥­æ§‹ç¯‰ãƒ»ãƒ“ã‚¸ãƒã‚¹ãƒ„ãƒ¼ãƒ«
      </div>
    </a>
    
    {{/* Dynamic Media Galleryã‚«ãƒ¼ãƒ‰ - ç‰¹åˆ¥æ‰±ã„ */}}
    <a href="#dynamic-media-gallery" class="saas-app-card" onclick="showSectionById('dynamic-media-gallery'); return false;">
      <video src="/videos/media_gallery_card.mp4" alt="Dynamic Media Gallery" style="width: 100%; height: 180px; object-fit: cover; border-radius: 8px; margin-bottom: 12px;" autoplay loop muted playsinline></video>
      <div class="saas-app-title">
        Dynamic Media Gallery
        <span class="saas-app-arrow">â†’</span>
      </div>
      <div class="saas-app-description">
        ãƒ¡ãƒ‡ã‚£ã‚¢ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‹•çš„ã«ã‚¹ã‚­ãƒ£ãƒ³ã—ã¦è¡¨ç¤ºã™ã‚‹ã‚®ãƒ£ãƒ©ãƒªãƒ¼
      </div>
      <div class="saas-app-features">
        â€¢ ãƒ•ã‚¡ã‚¤ãƒ«è‡ªå‹•ã‚¹ã‚­ãƒ£ãƒ³<br>
        â€¢ ã‚°ãƒªãƒƒãƒ‰/ãƒªã‚¹ãƒˆè¡¨ç¤º<br>
        â€¢ ãƒ©ã‚¤ãƒˆãƒœãƒƒã‚¯ã‚¹å¯¾å¿œ
      </div>
    </a>
  </div>
</div>

{{/* data/saas/ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‹ã‚‰å‹•çš„ã«ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’ç”Ÿæˆ */}}
{{/* å…¨YAMLãƒ•ã‚¡ã‚¤ãƒ«ã‚’å–å¾—ã—ã¦ã‚«ãƒ†ã‚´ãƒªåˆ¥ã«ã‚°ãƒ«ãƒ¼ãƒ—åŒ– */}}
{{ $categories := dict }}
{{ range $filename, $content := .Site.Data.saas }}
  {{ range $item := $content }}
    {{ if $item.category }}
      {{ $categoryName := $item.category_name | default "ãã®ä»–" }}
      {{ $categoryItems := index $categories $categoryName | default (slice) }}
      {{ $categoryItems = $categoryItems | append $item }}
      {{ $categories = merge $categories (dict $categoryName $categoryItems) }}
    {{ end }}
  {{ end }}
{{ end }}

{{/* ã‚«ãƒ†ã‚´ãƒªåˆ¥ã«ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’å‡ºåŠ› */}}
{{ $sortedCategories := slice "è¦ä»¶å®šç¾©ãƒ»é–‹ç™º" "ãƒ¡ãƒ‡ã‚£ã‚¢ã‚¨ãƒ‡ã‚£ã‚¿" "3Dã‚¨ãƒ‡ã‚£ã‚¿" "ãƒ“ã‚¸ãƒã‚¹ãƒ„ãƒ¼ãƒ«" "äº‹æ¥­æ§‹ç¯‰" "å¾“æ¥­å“¡" "SNSãƒ»ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°" "ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆ" }}

{{ range $categoryName := $sortedCategories }}
  {{ $items := index $categories $categoryName }}
  {{ if $items }}
    <div class="dashboard-sections">
      <h2 class="dashboard-section-title">{{ $categoryName }}</h2>
      <div class="dashboard-links">
        {{ range $item := $items }}
          {{/* ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã®åˆ¤å®š */}}
          {{ $isPrivate := false }}
          {{ $filename := "" }}
          {{ range $fname, $fcontent := $.Site.Data.saas }}
            {{ range $fitem := $fcontent }}
              {{ if eq $fitem.id $item.id }}
                {{ $filename = $fname }}
                {{ $isPrivate = or $item.private (hasPrefix $fname "private_") }}
              {{ end }}
            {{ end }}
          {{ end }}
          
          {{/* ã‚«ãƒ¼ãƒ‰ã®ç”Ÿæˆ */}}
          {{ $onClick := "" }}
          {{ if hasPrefix $item.id "requirements-" }}
            {{ $docId := strings.TrimPrefix $item.id "requirements-" }}
            {{ $onClick = printf "showRequirements('%s'); return false;" $docId }}
          {{ else if eq $item.id "slide-generator" }}
            {{ $onClick = "showBusinessTool('slide-generator'); return false;" }}
          {{ else if or (eq $item.category_name "äº‹æ¥­æ§‹ç¯‰") (eq $item.category_name "å¾“æ¥­å“¡") (eq $item.category_name "SNSãƒ»ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°") }}
            {{ $onClick = printf "showSectionById('%s'); return false;" $item.id }}
          {{ else }}
            {{ $appId := strings.TrimPrefix $item.id "saas-" }}
            {{ $onClick = printf "showSaasApp('%s'); return false;" $appId }}
          {{ end }}
          
          {{/* ãƒ“ãƒ‡ã‚ªã¾ãŸã¯ç”»åƒã®æ±ºå®š */}}
          {{ $media := "" }}
          {{ $mediaAlt := $item.title }}
          {{ if $item.video }}
            {{ $media = printf "<video src=\"%s\" alt=\"%s\" style=\"width: 100%%; height: 180px; object-fit: cover; border-radius: 8px; margin-bottom: 12px;\" autoplay loop muted playsinline></video>" $item.video $mediaAlt }}
          {{ else if $item.image }}
            {{ $media = printf "<img src=\"%s\" alt=\"%s\" style=\"width: 100%%; height: 180px; object-fit: cover; border-radius: 8px; margin-bottom: 12px;\">" $item.image $mediaAlt }}
          {{ else }}
            {{/* ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®å‹•ç”»ã‚’è¨­å®š */}}
            {{ $defaultVideo := "/videos/default_card.mp4" }}
            {{ $media = printf "<video src=\"%s\" alt=\"%s\" style=\"width: 100%%; height: 180px; object-fit: cover; border-radius: 8px; margin-bottom: 12px;\" autoplay loop muted playsinline></video>" $defaultVideo $mediaAlt }}
          {{ end }}
          
          <a href="#{{ $item.id }}" class="saas-app-card" onclick="{{ $onClick | safeJS }}">
            {{ $media | safeHTML }}
            <div class="saas-app-title">
              {{ $item.title }}
              {{ if $isPrivate }}
                <span class="private-badge">ğŸ”’</span>
              {{ end }}
              <span class="saas-app-arrow">â†’</span>
            </div>
            {{ if $item.content }}
              <div class="saas-app-description">{{ $item.content | markdownify }}</div>
            {{ end }}
            {{ if $item.features }}
              <div class="saas-app-features">
                {{ range $item.features }}
                  â€¢ {{ . }}<br>
                {{ end }}
              </div>
            {{ end }}
          </a>
        {{ end }}
      </div>
    </div>
  {{ end }}
{{ end }}

{{/* æ®‹ã‚Šã®ã‚«ãƒ†ã‚´ãƒªã‚’å‡¦ç†ï¼ˆä¸Šè¨˜ã®å®šç¾©æ¸ˆã¿ã‚«ãƒ†ã‚´ãƒªã«å«ã¾ã‚Œãªã„ã‚‚ã®ï¼‰ */}}
{{ range $categoryName, $items := $categories }}
  {{ if not (in $sortedCategories $categoryName) }}
    <div class="dashboard-sections">
      <h2 class="dashboard-section-title">{{ $categoryName }}</h2>
      <div class="dashboard-links">
        {{ range $item := $items }}
          {{/* ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã®åˆ¤å®š */}}
          {{ $isPrivate := false }}
          {{ $filename := "" }}
          {{ range $fname, $fcontent := $.Site.Data.saas }}
            {{ range $fitem := $fcontent }}
              {{ if eq $fitem.id $item.id }}
                {{ $filename = $fname }}
                {{ $isPrivate = or $item.private (hasPrefix $fname "private_") }}
              {{ end }}
            {{ end }}
          {{ end }}
          
          {{/* ã‚«ãƒ¼ãƒ‰ã®ç”Ÿæˆ */}}
          {{ $onClick := printf "showSectionById('%s'); return false;" $item.id }}
          
          {{/* ãƒ“ãƒ‡ã‚ªã¾ãŸã¯ç”»åƒã®æ±ºå®š */}}
          {{ $media := "" }}
          {{ $mediaAlt := $item.title }}
          {{ if $item.video }}
            {{ $media = printf "<video src=\"%s\" alt=\"%s\" style=\"width: 100%%; height: 180px; object-fit: cover; border-radius: 8px; margin-bottom: 12px;\" autoplay loop muted playsinline></video>" $item.video $mediaAlt }}
          {{ else if $item.image }}
            {{ $media = printf "<img src=\"%s\" alt=\"%s\" style=\"width: 100%%; height: 180px; object-fit: cover; border-radius: 8px; margin-bottom: 12px;\">" $item.image $mediaAlt }}
          {{ else }}
            {{/* ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®å‹•ç”»ã‚’è¨­å®š */}}
            {{ $defaultVideo := "/videos/default_card.mp4" }}
            {{ $media = printf "<video src=\"%s\" alt=\"%s\" style=\"width: 100%%; height: 180px; object-fit: cover; border-radius: 8px; margin-bottom: 12px;\" autoplay loop muted playsinline></video>" $defaultVideo $mediaAlt }}
          {{ end }}
          
          <a href="#{{ $item.id }}" class="saas-app-card" onclick="{{ $onClick | safeJS }}">
            {{ $media | safeHTML }}
            <div class="saas-app-title">
              {{ $item.title }}
              {{ if $isPrivate }}
                <span class="private-badge">ğŸ”’</span>
              {{ end }}
              <span class="saas-app-arrow">â†’</span>
            </div>
            {{ if $item.content }}
              <div class="saas-app-description">{{ $item.content | markdownify }}</div>
            {{ end }}
            {{ if $item.features }}
              <div class="saas-app-features">
                {{ range $item.features }}
                  â€¢ {{ . }}<br>
                {{ end }}
              </div>
            {{ end }}
          </a>
        {{ end }}
      </div>
    </div>
  {{ end }}
{{ end }}

{{/* å¿…è¦ãªJavaScripté–¢æ•° */}}
<script>
  // æ±ç”¨: ä»»æ„ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’è¡¨ç¤º
  window.showSectionById = function(id) {
    document.querySelectorAll('.doc-section').forEach(section => {
      section.style.display = 'none';
    });
    const target = document.getElementById(id);
    if (target) {
      target.style.display = 'block';
      window.history.pushState({ direct: id }, '', '#' + id);
      window.scrollTo(0, 0);
    }
  }
  
  // ãƒ“ã‚¸ãƒã‚¹ãƒ„ãƒ¼ãƒ«è¡¨ç¤ºç”¨ã®é–¢æ•°
  window.showBusinessTool = function(toolId) {
    document.querySelectorAll('.doc-section').forEach(section => {
      section.style.display = 'none';
    });
    
    const targetSection = document.getElementById(toolId);
    if (targetSection) {
      targetSection.style.display = 'block';
      window.history.pushState({ direct: toolId }, '', '#' + toolId);
      window.scrollTo(0, 0);
    }
  }

  // SaaSã‚¢ãƒ—ãƒªè¡¨ç¤ºç”¨ã®é–¢æ•°
  window.showSaasApp = function(appId) {
    document.querySelectorAll('.doc-section').forEach(section => {
      section.style.display = 'none';
    });
    
    const targetId = 'saas-' + appId;
    const targetSection = document.getElementById(targetId);
    if (targetSection) {
      targetSection.style.display = 'block';
      window.history.pushState({ direct: targetId }, '', '#' + targetId);
      window.scrollTo(0, 0);
    }
  }

  // è¦ä»¶å®šç¾©æ›¸è¡¨ç¤ºç”¨ã®é–¢æ•°
  window.showRequirements = function(docId) {
    document.querySelectorAll('.doc-section').forEach(section => {
      section.style.display = 'none';
    });
    
    let targetId;
    if (docId === 'views') {
      targetId = 'ui-views';
    } else {
      targetId = 'requirements-' + docId;
    }
    
    const targetSection = document.getElementById(targetId);
    if (targetSection) {
      targetSection.style.display = 'block';
      window.history.pushState({ direct: targetId }, '', '#' + targetId);
      window.scrollTo(0, 0);
    }
  }

  // ãƒ–ãƒ©ã‚¦ã‚¶ã®æˆ»ã‚‹/é€²ã‚€ãƒœã‚¿ãƒ³ã¸ã®å¯¾å¿œ
  window.addEventListener('popstate', function(event) {
    if (event.state && event.state.direct) {
      showSectionById(event.state.direct);
    } else {
      // ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã«æˆ»ã™
      document.querySelectorAll('.doc-section').forEach(section => {
        if (section.id === 'saas-applications-overview') {
          section.style.display = 'block';
        } else {
          section.style.display = 'none';
        }
      });
    }
  });
  
  // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«URLã‚’ãƒã‚§ãƒƒã‚¯
  document.addEventListener('DOMContentLoaded', function() {
    const hash = window.location.hash;
    if (hash && hash.startsWith('#saas-')) {
      const appId = hash.replace('#saas-', '');
      setTimeout(() => showSaasApp(appId), 100);
    } else if (hash && hash.startsWith('#requirements-')) {
      const docId = hash.replace('#requirements-', '');
      setTimeout(() => showRequirements(docId), 100);
    } else if (hash === '#ui-views') {
      setTimeout(() => showRequirements('views'), 100);
    } else if (hash === '#slide-generator') {
      setTimeout(() => showBusinessTool('slide-generator'), 100);
    } else if (hash === '#biz-strategy' || hash === '#biz-finance' || hash === '#prompts-repo') {
      setTimeout(() => showSectionById(hash.replace('#','')), 100);
    } else {
      // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã®ã¿è¡¨ç¤º
      document.querySelectorAll('.doc-section').forEach(section => {
        if (section.id === 'saas-applications-overview') {
          section.style.display = 'block';
        } else {
          section.style.display = 'none';
        }
      });
    }
  });
</script>